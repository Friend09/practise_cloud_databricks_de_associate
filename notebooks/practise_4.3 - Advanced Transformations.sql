-- Databricks notebook source
-- MAGIC %md
-- MAGIC # Performing Advanced ETL Transformations

-- COMMAND ----------

-- MAGIC %md-sandbox
-- MAGIC
-- MAGIC <div  style="text-align: center;">
-- MAGIC   <img src="https://raw.githubusercontent.com/derar-alhussein/oreilly-databricks-dea/main/Includes/Images/school_schema.png" alt="School Schema">
-- MAGIC </div>

-- COMMAND ----------

-- MAGIC %run ../Includes/School-Setup

-- COMMAND ----------

-- MAGIC %md
-- MAGIC
-- MAGIC ## Dealing with Nested JSON Data

-- COMMAND ----------



-- COMMAND ----------



-- COMMAND ----------




-- COMMAND ----------

-- MAGIC %md
-- MAGIC ## Parsing JSON into Struct Type

-- COMMAND ----------





-- COMMAND ----------









-- COMMAND ----------



-- COMMAND ----------

-- MAGIC %md
-- MAGIC ## Interacting with Struct Types

-- COMMAND ----------




-- COMMAND ----------

-- MAGIC %md
-- MAGIC ## Flattening Struct Types

-- COMMAND ----------







-- COMMAND ----------

-- MAGIC %md
-- MAGIC ## Leveraging the explode Function

-- COMMAND ----------




-- COMMAND ----------




-- COMMAND ----------

-- MAGIC %md
-- MAGIC ## Aggregating Unique Values 

-- COMMAND ----------







-- COMMAND ----------







-- COMMAND ----------

-- MAGIC %md
-- MAGIC
-- MAGIC ## Mastering Join Operations in Spark SQL

-- COMMAND ----------











-- COMMAND ----------

-- MAGIC %md
-- MAGIC ## Exploring Set Operations in Spark SQL

-- COMMAND ----------




-- COMMAND ----------

-- MAGIC %md
-- MAGIC ### Union operation

-- COMMAND ----------





-- COMMAND ----------

-- MAGIC %md
-- MAGIC ### Intersect operation

-- COMMAND ----------





-- COMMAND ----------

-- MAGIC %md
-- MAGIC ### Minus operation

-- COMMAND ----------





-- COMMAND ----------

-- MAGIC %md
-- MAGIC ## Changing Data Perspectives

-- COMMAND ----------











